<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libusual: usual/hashtab-impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libusual&#160;<span id="projectnumber">0.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">usual/hashtab-impl.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Simple customizable hashtable implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_hash_item.html">HashItem</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a> slot.  <a href="struct_hash_item.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_hash_tab.html">HashTab</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Single <a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a> segment.  <a href="struct_hash_tab.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a24605ab6be02cb5452cefca17116ea54">HTAB_KEY_T</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridable type for key.  <a href="#a24605ab6be02cb5452cefca17116ea54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#aa6c9d77fed4c88bf60c67ad97226c138">HTAB_VAL_T</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridable type for value.  <a href="#aa6c9d77fed4c88bf60c67ad97226c138"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#aad968df3bf7ec4579616118dfb45e77a">HTAB_MAX_FILL</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Max fill percentage.  <a href="#aad968df3bf7ec4579616118dfb45e77a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef HTAB_KEY_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef for key.  <a href="#a385a2461ac9edf9731028799a95468bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef HTAB_VAL_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef for value.  <a href="#a84f65bc167579c2087fd0df5a52435b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef bool(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a4375b1b7c2d66f269b417aaa1ca8f257">hash_cmp_fn</a> )(const <a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a> curval, const void *arg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Signature for comparision function.  <a href="#a4375b1b7c2d66f269b417aaa1ca8f257"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a9e99cc90ac0a0fe159e48b4b86ae26aa">hashtab_create</a> (unsigned size, <a class="el" href="hashtab-impl_8h.html#a4375b1b7c2d66f269b417aaa1ca8f257">hash_cmp_fn</a> cmp_fn, <a class="el" href="struct_cx_mem.html">CxMem</a> *ca)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize <a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a>.  <a href="#a9e99cc90ac0a0fe159e48b4b86ae26aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a4ace547e0fd8c894a0cd95c8c452352b">hashtab_destroy</a> (struct <a class="el" href="struct_hash_tab.html">HashTab</a> *h)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free <a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a>.  <a href="#a4ace547e0fd8c894a0cd95c8c452352b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a30d6d65c4a87148f0ef82a935dfc331c">hashtab_lookup</a> (struct <a class="el" href="struct_hash_tab.html">HashTab</a> *h, <a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a> key, bool do_insert, const void *arg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Element lookup, optionally inserting new slot.  <a href="#a30d6d65c4a87148f0ef82a935dfc331c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a73be4302ca9a85f10c80614553791ccb">hashtab_delete</a> (struct <a class="el" href="struct_hash_tab.html">HashTab</a> *h, <a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a> key, void *arg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete an element.  <a href="#a73be4302ca9a85f10c80614553791ccb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a40d580e2ce7453b4c1a9b63921ad5dec">hashtab_stats</a> (struct <a class="el" href="struct_hash_tab.html">HashTab</a> *h, unsigned *nitem_p, unsigned *ntab_p)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Count elements and fragments.  <a href="#a40d580e2ce7453b4c1a9b63921ad5dec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hashtab-impl_8h.html#a2405f62b248cc3f85fbb5540df190138">hashtab_copy</a> (struct <a class="el" href="struct_hash_tab.html">HashTab</a> *h_old, unsigned newsize)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy elements to new hashtab, perhaps with different size.  <a href="#a2405f62b248cc3f85fbb5540df190138"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Simple customizable hashtable implementation. </p>
<ul>
<li>Fixed-size hash table, open-addressed</li>
<li>Extended by linking several together</li>
<li>Resizable by copying.</li>
<li>Can be lockless in multi-reader, one-writer situation if mempory barrier macros are defined. This also requires that <a class="el" href="struct_hash_item.html" title="HashTab slot.">HashItem</a> must not be split across cachelines. </li>
</ul>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a24605ab6be02cb5452cefca17116ea54"></a><!-- doxytag: member="hashtab&#45;impl.h::HTAB_KEY_T" ref="a24605ab6be02cb5452cefca17116ea54" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTAB_KEY_T</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridable type for key. </p>

</div>
</div>
<a class="anchor" id="aa6c9d77fed4c88bf60c67ad97226c138"></a><!-- doxytag: member="hashtab&#45;impl.h::HTAB_VAL_T" ref="aa6c9d77fed4c88bf60c67ad97226c138" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTAB_VAL_T</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridable type for value. </p>

</div>
</div>
<a class="anchor" id="aad968df3bf7ec4579616118dfb45e77a"></a><!-- doxytag: member="hashtab&#45;impl.h::HTAB_MAX_FILL" ref="aad968df3bf7ec4579616118dfb45e77a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTAB_MAX_FILL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Max fill percentage. </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a385a2461ac9edf9731028799a95468bf"></a><!-- doxytag: member="hashtab&#45;impl.h::htab_key_t" ref="a385a2461ac9edf9731028799a95468bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef HTAB_KEY_T <a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Typedef for key. </p>

</div>
</div>
<a class="anchor" id="a84f65bc167579c2087fd0df5a52435b1"></a><!-- doxytag: member="hashtab&#45;impl.h::htab_val_t" ref="a84f65bc167579c2087fd0df5a52435b1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef HTAB_VAL_T <a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Typedef for value. </p>

</div>
</div>
<a class="anchor" id="a4375b1b7c2d66f269b417aaa1ca8f257"></a><!-- doxytag: member="hashtab&#45;impl.h::hash_cmp_fn" ref="a4375b1b7c2d66f269b417aaa1ca8f257" args=")(const htab_val_t curval, const void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef bool(* <a class="el" href="hashtab-impl_8h.html#a4375b1b7c2d66f269b417aaa1ca8f257">hash_cmp_fn</a>)(const <a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a> curval, const void *arg)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Signature for comparision function. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9e99cc90ac0a0fe159e48b4b86ae26aa"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_create" ref="a9e99cc90ac0a0fe159e48b4b86ae26aa" args="(unsigned size, hash_cmp_fn cmp_fn, CxMem *ca)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="struct_hash_tab.html">HashTab</a>* hashtab_create </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab-impl_8h.html#a4375b1b7c2d66f269b417aaa1ca8f257">hash_cmp_fn</a>&#160;</td>
          <td class="paramname"><em>cmp_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cx_mem.html">CxMem</a> *&#160;</td>
          <td class="paramname"><em>ca</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize <a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a>. </p>

<p>References <a class="el" href="cxalloc_8h.html#aba9810d5b22aedfda47bb5cb89a7a7e9">cx_alloc0()</a>.</p>

<p>Referenced by <a class="el" href="hashtab-impl_8h.html#a2405f62b248cc3f85fbb5540df190138">hashtab_copy()</a>, and <a class="el" href="hashtab-impl_8h.html#a30d6d65c4a87148f0ef82a935dfc331c">hashtab_lookup()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ace547e0fd8c894a0cd95c8c452352b"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_destroy" ref="a4ace547e0fd8c894a0cd95c8c452352b" args="(struct HashTab *h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void hashtab_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free <a class="el" href="struct_hash_tab.html" title="Single HashTab segment.">HashTab</a>. </p>

<p>References <a class="el" href="cxalloc_8h.html#a4f164c826ae312bbf68fc784066db6ac">cx_free()</a>.</p>

<p>Referenced by <a class="el" href="hashtab-impl_8h.html#a2405f62b248cc3f85fbb5540df190138">hashtab_copy()</a>.</p>

</div>
</div>
<a class="anchor" id="a30d6d65c4a87148f0ef82a935dfc331c"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_lookup" ref="a30d6d65c4a87148f0ef82a935dfc331c" args="(struct HashTab *h, htab_key_t key, bool do_insert, const void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="hashtab-impl_8h.html#a84f65bc167579c2087fd0df5a52435b1">htab_val_t</a>* hashtab_lookup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_insert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Element lookup, optionally inserting new slot. </p>

<p>References <a class="el" href="hashtab-impl_8h.html#a9e99cc90ac0a0fe159e48b4b86ae26aa">hashtab_create()</a>.</p>

<p>Referenced by <a class="el" href="hashtab-impl_8h.html#a2405f62b248cc3f85fbb5540df190138">hashtab_copy()</a>, and <a class="el" href="hashtab-impl_8h.html#a73be4302ca9a85f10c80614553791ccb">hashtab_delete()</a>.</p>

</div>
</div>
<a class="anchor" id="a73be4302ca9a85f10c80614553791ccb"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_delete" ref="a73be4302ca9a85f10c80614553791ccb" args="(struct HashTab *h, htab_key_t key, void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void hashtab_delete </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hashtab-impl_8h.html#a385a2461ac9edf9731028799a95468bf">htab_key_t</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete an element. </p>

<p>References <a class="el" href="base_8h.html#a9811c6fb466ff1d04ff9052422edb9fe">container_of</a>, and <a class="el" href="hashtab-impl_8h.html#a30d6d65c4a87148f0ef82a935dfc331c">hashtab_lookup()</a>.</p>

</div>
</div>
<a class="anchor" id="a40d580e2ce7453b4c1a9b63921ad5dec"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_stats" ref="a40d580e2ce7453b4c1a9b63921ad5dec" args="(struct HashTab *h, unsigned *nitem_p, unsigned *ntab_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void hashtab_stats </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>nitem_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>ntab_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Count elements and fragments. </p>

</div>
</div>
<a class="anchor" id="a2405f62b248cc3f85fbb5540df190138"></a><!-- doxytag: member="hashtab&#45;impl.h::hashtab_copy" ref="a2405f62b248cc3f85fbb5540df190138" args="(struct HashTab *h_old, unsigned newsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="struct_hash_tab.html">HashTab</a>* hashtab_copy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_hash_tab.html">HashTab</a> *&#160;</td>
          <td class="paramname"><em>h_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>newsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy elements to new hashtab, perhaps with different size. </p>

<p>References <a class="el" href="hashtab-impl_8h.html#a9e99cc90ac0a0fe159e48b4b86ae26aa">hashtab_create()</a>, <a class="el" href="hashtab-impl_8h.html#a4ace547e0fd8c894a0cd95c8c452352b">hashtab_destroy()</a>, and <a class="el" href="hashtab-impl_8h.html#a30d6d65c4a87148f0ef82a935dfc331c">hashtab_lookup()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
